#!/usr/bin/env bash

# Wrapper for nvim.
#
# Launch a terminal to run nvim in, unless we are already in one. This means we
# can be called from the command-line and from situations with no terminal
# (e.g. a desktop custom shortcut key)
#
# Fallback to vim if nvim is not installed, to make it safe to use this for things
# one would rather not fail, such as $EDITOR.

# Prefer nvim, fallback to vim
editor=nvim
if ! type -P nvim >/dev/null; then
    editor=vim
fi

# If we are not in a terminal, open one
# Run the terminal synchronously (--wait) so that we work as $EDITOR
if [ "$(tty)" = "not a tty" ]; then
    gnome-terminal --wait -- $editor "$@"
else
    $editor "$@"
fi

